CREATE DATABASE BIDVESTBANK;

SHOW DATABASES; 

USE BIDVESTBANK;

CREATE TABLE BANKBRANCH
(
BRANCH_NAME VARCHAR(15) NOT NULL,
BRANCH_CITY VARCHAR (15) NOT NULL,
ASSETS INT NOT NULL
);

CREATE TABLE CUSTOMER
(
CUSTOMER_NAME VARCHAR(15) NOT NULL,
CUSTOMER_STREET VARCHAR(15) NOT NULL,
CUSTOMER_CITY VARCHAR(15) NOT NULL
);

CREATE TABLE CUSTOMERACCOUNT
(
ACCOUNT_NUMBER CHAR(6) NOT NULL PRIMARY KEY,
BRANCH_NAME VARCHAR (15) NOT NULL,
BALANCE DOUBLE NOT NULL
);

CREATE TABLE LOAN
(
LOAN_NUMBER CHAR(4) NOT NULL PRIMARY KEY,
BRANCH_NAME VARCHAR(15) NOT NULL,
AMOUNT DOUBLE NOT NULL
);

CREATE TABLE DEPOSITOR
(
CUSTOMER_NAME VARCHAR(15) NOT NULL,
ACCOUNT_NUMBER CHAR(6) NOT NULL
);

CREATE TABLE BORROWER
(
CUSTOMER_NAME VARCHAR(15) NOT NULL,
LOAN_NUMBER CHAR(4) NOT NULL
);

CREATE TABLE EMPLOYEE
(
EMPLOYEE_NAME VARCHAR(10) NOT NULL,
BRANCH_NAME VARCHAR(15) NOT NULL,
SALARY DOUBLE NOT NULL
);

INSERT INTO BANKBRANCH VALUES('MIDRAND', 'JOHANNESBURG', 7100000);
INSERT INTO BANKBRANCH VALUES('NEWTOWN', 'JOHANNESBURG', 9000000);
INSERT INTO BANKBRANCH VALUES('MABOPANE', 'PRETORIA', 400000);
INSERT INTO BANKBRANCH VALUES('BELGRAVIA', 'KIMBERLY', 3700000);
INSERT INTO BANKBRANCH VALUES('SUNNYSIDE', 'PRETORIA', 1700000);
INSERT INTO BANKBRANCH VALUES('AMAZIMTOTI', 'DURBAN', 300000);
INSERT INTO BANKBRANCH VALUES('UNIVERSITAS', 'BLOEMFONTEIN', 2100000);
INSERT INTO BANKBRANCH VALUES('MAMELODI', 'PRETORIA', 8000000);

INSERT INTO CUSTOMER VALUES('MODISE', 'SPRING', 'GEORGE');
INSERT INTO CUSTOMER VALUES('BROOKS', 'SENATOR', 'JOHANNESBURG');
INSERT INTO CUSTOMER VALUES('JOOSTE', 'NORTH', 'KIMBERLY');
INSERT INTO CUSTOMER VALUES('LOMBARD', 'SAND HILL', 'NELSPRUIT');
INSERT INTO CUSTOMER VALUES('MOKWENA', 'WALNUT', 'PORT-ELIZABETH');
INSERT INTO CUSTOMER VALUES('JOHNSON', 'MMBATHO', 'MAFIKENG');
INSERT INTO CUSTOMER VALUES('JOHNSON', 'ALMAL', 'BLOEMFONTEIN');
INSERT INTO CUSTOMER VALUES('ZWANE', 'MAIN', 'MAFIKENG');
INSERT INTO CUSTOMER VALUES('LINDSAY', 'PARK', 'GEORGE');
INSERT INTO CUSTOMER VALUES('SMITH', 'NORTH', 'KIMBERLY');
INSERT INTO CUSTOMER VALUES('DLAMINI', 'PUTNAM', 'PORT-ELIZABETH');
INSERT INTO CUSTOMER VALUES('WILLIAMS', 'NASSAU', 'GIYANE');

INSERT INTO CUSTOMERACCOUNT VALUES('A-5324', 'NEWTOWN', 500);
INSERT INTO CUSTOMERACCOUNT VALUES('A-5624', 'SUNNYSIDE', 400);
INSERT INTO CUSTOMERACCOUNT VALUES('A-7794', 'MIDRAND', 900);
INSERT INTO CUSTOMERACCOUNT VALUES('A-4467', 'MABOPANE', 700);
INSERT INTO CUSTOMERACCOUNT VALUES('A-3546', 'MIDRAND', 750);
ALTER TABLE CUSTOMERACCOUNT MODIFY BRANCH_NAME VARCHAR(20);
INSERT INTO CUSTOMERACCOUNT VALUES('A-3453', 'UNIVERSITAS', 700);
INSERT INTO CUSTOMERACCOUNT VALUES('A-2542', 'MAMELODI', 350);

INSERT INTO LOAN VALUES('L-11', 'MAMELODI', 900);
INSERT INTO LOAN VALUES('L-14', 'NEWTOWN', 1500);
INSERT INTO LOAN VALUES('L-15', 'SUNNYSIDE', 1500);
INSERT INTO LOAN VALUES('L-16', 'SUNNYSIDE', 1300);
INSERT INTO LOAN VALUES('L-17', 'NEWTOWN', 1000);
INSERT INTO LOAN VALUES('L-23', 'UNIVERSITAS', 2000);
INSERT INTO LOAN VALUES('L-93', 'MABOPANE', 500);

INSERT INTO DEPOSITOR VALUES('JOHNSON', 'A-5624');
INSERT INTO DEPOSITOR VALUES('JOHNSON', 'A-7794');
INSERT INTO DEPOSITOR VALUES('ZWANE', 'A-3546');
INSERT INTO DEPOSITOR VALUES('LINDSAY', 'A-3453');
INSERT INTO DEPOSITOR VALUES('SMITH', 'A-4467');
INSERT INTO DEPOSITOR VALUES('DLAMINI', 'A-2542');

INSERT INTO BORROWER VALUES('MODISE', 'L-16');
INSERT INTO BORROWER VALUES('JOOSTE', 'L-93');
INSERT INTO BORROWER VALUES('JOHNSON', 'L-15');
INSERT INTO BORROWER VALUES('JACKSON', 'L-14');
INSERT INTO BORROWER VALUES('ZWANE', 'L-17');
INSERT INTO BORROWER VALUES('SMITH', 'L-11');
INSERT INTO BORROWER VALUES('SMITH', 'L-23');
INSERT INTO BORROWER VALUES('WILLIAMS', 'L-18');

INSERT INTO EMPLOYEE VALUES('MODISE', 'SUNNYSIDE', 1500);
INSERT INTO EMPLOYEE VALUES('BROWN', 'SUNNYSIDE', 1300);
INSERT INTO EMPLOYEE VALUES('GOPAL', 'SUNNYSIDE', 5300);
INSERT INTO EMPLOYEE VALUES('JOHNSON', 'NEWTOWN', 1500);
INSERT INTO EMPLOYEE VALUES('LOREENA', 'NEWTOWN', 1300);
INSERT INTO EMPLOYEE VALUES('PETERSON', 'NEWTOWN', 2500);
INSERT INTO EMPLOYEE VALUES('RAO', 'AUSTIN', 1500);
INSERT INTO EMPLOYEE VALUES('SATO', 'AUSTIN', 1600);

SHOW TABLES;
SELECT * FROM BANKBRANCH;
SELECT * FROM CUSTOMER;
SELECT * FROM CUSTOMERACCOUNT;
SELECT * FROM LOAN;
SELECT * FROM DEPOSITOR;
SELECT * FROM BORROWER;
SELECT * FROM EMPLOYEE;

SELECT ACCOUNT_NUMBER FROM CUSTOMERACCOUNT WHERE BALANCE < 700;

SELECT * FROM CUSTOMERACCOUNT WHERE BALANCE < 700;

SELECT CUSTOMER_NAME FROM CUSTOMER WHERE CUSTOMER_CITY = 'JOHANNESBURG';

SELECT * FROM EMPLOYEE WHERE SALARY > 1500 AND BRANCH_NAME != 'NEWTOWN';

SELECT AVG(SALARY) AS 'AVG_SALARY'FROM EMPLOYEE;

SELECT MAX(ASSETS), BRANCH_NAME FROM BANKBRANCH;

SELECT EMPLOYEE_NAME FROM EMPLOYEE WHERE BRANCH_NAME = 'SUNNYSIDE';

SELECT * FROM BORROWER;

SELECT ACCOUNT_NUMBER FROM CUSTOMERACCOUNT WHERE BALANCE > 900;

SELECT ACCOUNT_NUMBER, BALANCE FROM CUSTOMERACCOUNT WHERE BRANCH_NAME = 'NEWTOWN' AND BALANCE > 600;

SELECT BRANCH_NAME, ASSETS FROM BANKBRANCH;
